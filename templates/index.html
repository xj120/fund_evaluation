
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="./static/css/all.css">
    <script src="https://kit.fontawesome.com/yourcode.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
     <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <style>

       .upper{
       height:60px;
       background-color:#F5F5F5;
       border-bottom:1px solid #fff;
      box-shadow:0px 15px 10px -15px #000;
       }

       .URLrecorded{
       height:60px;
       width:200px;
       line-height:60px;
       margin-left:40px;
       }

       .main{
       margin-left:60px;
       margin-right:60px;
       border-width:1px;
       border-color:#F8F8F8;
       border-style:solid;
       }

       .header{
       height:60px;
       }

input{
       height:40px;
       width:120px;
       background-color:#007BFF;
       color:white;
       border:none;
       float:right;
       margin-right:10px;
       margin-top:10px;
       }

.del{
height:20px;
width:60px;
}

.spi{
height:20px;
width:60px;
}

.textInput{
background-color:white;
color:black;
height:30px;
width:160px;
float:none;
margin-left:120px;

}

.buttonInput{
background-color:white;
color:black;
float:left;
margin-left:140px;
}

       .leftHead{
       float:left;
       width:100px;
       height:60px;
       text-align:center;
       line-height:60px;
       }

       table{
       width:100%;
       }
       tr
       {
       text-align:left;
       }
       th, td {
  border-bottom: 1px solid #ddd;
}
       i{
       margin-left:5px;
       margin-right:5px;
       }

       a{
       -webkit-user-select: none
       }

       .hide{
       display:none;
       }
       .c1{
       position:fixed;
       top:0;
       buttom:0;
       left:0;
       right:0;
       z-index:2;
       background:rgba(0,0,0,.5)
       }
       .c2{
       background-color:#EEE9E9;

       position:fixed;
       width:400px;
       height:300px;
       top:50%;
       left:50%;
       z-index:3;
       margin-top:-150px;
       margin-left:-200px;
       }

       .text
       {
height:30px;
width:160px;
margin-left:160px;
line-height:30px;
       }
    </style>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="upper">
    <div class="URLrecorded">已记录URL</div>
</div>
<div class="main">
<div class="header">
    <div class="leftHead" >URL列表</div>
<form name="createURL" >
   <input type="button" onclick="show()" value="新建URL">
</form>
<form name="spiderALL">
    <input type="button" value="爬取全部" onclick= spideall()>
</div>
    <script>
        function spideall(){
        var urltb = document.getElementById('URLtable')
        var row = urltb.rows;
for(var i =2;i<row.length;i++)
        {
        var cell = row[i].cells;
        alert(cell[0].innerHTML)
        var myDate = new Date();
        cell[1].innerText = myDate;
        $.ajax({
            type: 'POST',
            url: '/spide',
            data: {'url':cell[0].innerHTML},
            dataType: 'json',
            success: function () {
                alert("成功");
            },
            error: function () {
                alert("失败");
            }
        })
        }
        }
    </script>
</form>


    <table id="URLtable">

        <tr>
            <th>URL <i class="fas fa-chevron-up"></i></th>
            <th>数据最后时间</th>
            <th>操作</th>
        </tr>



        <tr hidden="hidden">
            <td></td>
            <td id="time">数据未爬取</td>
            <td id="actions"> <input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>

{% for i in content %}
        {% for j in i%}
        <tr>
        <td>j[0]</td>
        <td>j[1]</td>
        <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        {% endfor %}
        {% endfor %}


        <tr>
            <td>https://qieman.com/portfolios/ZH012926</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>

        <tr>
            <td>https://qieman.com/portfolios/ZH001798</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH039471</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH010246</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH006498</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH000193</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH009664</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH000193</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH030684</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH017252</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH007973</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH037807</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH007974</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH017409</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH035411</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH043108</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://qieman.com/portfolios/ZH043126</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://danjuanapp.com/strategy/CSI1033?channel=1300100141</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://danjuanapp.com/strategy/CSI1032?channel=1300100141</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://danjuanapp.com/strategy/CSI1038?channel=1300100141</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://danjuanapp.com/strategy/CSI1029?channel=1300100141</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://danjuanapp.com/strategy/CSI1006?channel=1300100141</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>
        <tr>
            <td>https://danjuanapp.com/strategy/CSI1065?channel=1300100141</td>
            <td>数据未爬取</td>
            <td><input type = "submit" value="删除" class="del"><input type ="submit" value="爬取" class="spi" onclick= spide(this)></td>
        </tr>


 </table>
        <script>
        var TB = document.getElementsByTagName('tbody')[0];
	    var myContent = document.getElementById('content');

	    // 给tbody绑定点击事件（事件委托）
	    TB.onclick = function (e) {
	        // 如果当前点击的是删除按钮
	        if (e.target.className == 'del') {

	                // e.target 为当前点击对象--->删除
	                // e.target.parentElement ---> td
	                // e.target.parentElement.parentElement  ---> tr
                    alert(e.target.parentElement.parentElement.children[0].innerText);

	                TB.removeChild(e.target.parentElement.parentElement)

	        }
	        }
        </script>>
        <script>

function spide(td){
alert(td.parentElement.parentElement.children[0].innerText)
alert(td.parentElement.parentElement.children[1].innerText)
var myDate = new Date();
td.parentElement.parentElement.children[1].innerText = myDate;
$.ajax({
            type: 'POST',
            url: '/spide',
            data: {'url':td.parentElement.parentElement.children[0].innerText},
            dataType: 'json',
            success: function () {
                alert("成功");
            },
            error: function () {
                alert("失败");
            }
        })
}

        </script>

</div>
<div id="shade" class="c1 hide"></div>
<div id="modal" class="c2 hide">
    <p class="text">添加URL</p>
<form onsubmit="return addURL()">
    <input type="text" name="URL" class="textInput" id = "urlinput"><br>
    <input type="button"  value="确定" onclick="return addURL()" class="buttonInput">
</form>
    <input type="button" value="取消" onclick="Hide()" class="buttonInput">
</div>

<script type="text/javascript">


function addURL(){

var url = document.getElementById('urlinput').value
alert(url)
var time = document.getElementById('time').innerHTML
alert(time)
var actions = document.getElementById('actions').innerHTML
alert(actions)
tb = document.getElementById('URLtable')
var row = document.createElement('tr'); //创建行

	 var idCell = document.createElement('td'); //创建第一列id
	 idCell.innerHTML = url; //填充数据
	 row.appendChild(idCell); //加入行  ，下面类似

	 var nameCell = document.createElement('td');//创建第二列name
	 nameCell.innerHTML = time;
	 row.appendChild(nameCell);

	 var jobCell = document.createElement('td');//创建第三列job
	 jobCell.innerHTML = actions;
	 row.appendChild(jobCell)

	 tb.appendChild(row)
}
</script>

<script>
function show()
{
document.getElementById("shade").classList.remove('hide')
document.getElementById("modal").classList.remove('hide')
}
function Hide()
{
document.getElementById("shade").classList.add("hide");
document.getElementById("modal").classList.add("hide");
}
</script>
</body>
</html>